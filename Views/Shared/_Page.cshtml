@using ECom_wep_app.Models.Utilities
@model IPaginated
@{
    var currentSearch = Context.Request.Query["searchTerm"].ToString();
    var currentPageSize = int.TryParse(Context.Request.Query["pageSize"], out var ps) ? ps : (Model?.PageSize ?? 10);
    var currentPageIndex = Model?.PageIndex ?? 1;
    var totalPages = Model?.TotalPages ?? 0;
}

@if (totalPages > 0)
{
    <div class="d-flex justify-content-between mt-4 align-items-center">
        <div>
            Page @currentPageIndex of @totalPages
            <span class="text-muted ms-2">(Total: @Model.TotalCount, PageSize: @Model.PageSize)</span>
        </div>

        <nav aria-label="Pagination">
            <ul class="pagination mb-0">
                <li class="page-item @(Model.HasPreviousPage ? "" : "disabled")">
                    <a class="page-link"
                       asp-action="List"
                       asp-route-pageIndex="@(currentPageIndex - 1)"
                       asp-route-pageSize="@(currentPageSize)"
                       asp-route-searchTerm="@(currentSearch)"
                       aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                    </a>
                </li>

                @for (int i = 1; i <= totalPages; i++)
                {
                    <li class="page-item @(i == currentPageIndex ? "active" : "")">
                        <a class="page-link"
                           asp-action="List"
                           asp-route-pageIndex="@i"
                           asp-route-pageSize="@(currentPageSize)"
                           asp-route-searchTerm="@(currentSearch)">
                            @i
                        </a>
                    </li>
                }

                <li class="page-item @(Model.HasNextPage ? "" : "disabled")">
                    <a class="page-link"
                       asp-action="List"
                       asp-route-pageIndex="@(currentPageIndex + 1)"
                       asp-route-pageSize="@(currentPageSize)"
                       asp-route-searchTerm="@(currentSearch)"
                       aria-label="Next">
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            </ul>
        </nav>
    </div>
}
else
{
    <div class="mt-3 text-muted">No results.</div>
}
